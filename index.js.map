{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const fetchImages = async (searchValue, pageNumber, perPage) => {\n  const params = new URLSearchParams({\n    key: '46368026-ceb8dba76cba5a0f9c417db4a',\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: perPage,\n    page: pageNumber,\n  });\n  return axios.get(`https://pixabay.com/api/?${params.toString()}`);\n};","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst simpleLightboxGallery = new SimpleLightbox('.search-result li a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport const renderToastOnSearchEmpty = (parentContainer) => {\n  iziToast.error({\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n  });\n};\n\nexport const renderToastOnError = (parentContainer) => {\n  parentContainer.innerHTML = '';\n  iziToast.error({\n    message: 'Something went wrong. Please try again!',\n    position: 'topRight',\n  });\n};\n\nexport const renderGallery = (parentContainer, images) => {\n  parentContainer.insertAdjacentHTML('beforeend', images.map(renderImage).join(''))\n  simpleLightboxGallery.refresh();\n};\n\nexport const renderLoader = (parentContainer) => {\n  parentContainer.innerHTML = `<span class='loader'/>`;\n};\n\nexport const hideLoader = (parentContainer) => {\n  parentContainer.innerHTML = '';\n};\n\nexport const toggleButtonVisibility = (button, isShow) => {\n  if (isShow) {\n    button.classList.remove('hidden');\n  } else {\n    button.classList.add('hidden');\n  }\n};\n\nconst renderImage = (image) => {\n  return `\n    <li class='search-result-item'>\n      <a href='${image.largeImageURL}'>\n        <img class='search-result-item-image' src='${image.webformatURL}' alt='${image.tags}'/>\n      </a>\n      <ul class='search-result-item-text'>\n        <li class='field'>\n          <div class='label'>\n            Likes\n          </div>\n          <div class='value'>\n            ${image.likes}\n          </div>\n        </li>\n        <li class='field'>\n          <div class='label'>\n            Views\n          </div>\n          <div class='value'>\n            ${image.views}\n          </div>\n        </li>\n        <li class='field'>\n          <div class='label'>\n            Comments\n          </div>\n          <div class='value'>\n            ${image.comments}\n          </div>\n        </li>\n        <li class='field'>\n          <div class='label'>\n            Downloads\n          </div>\n          <div class='value'>\n            ${image.downloads}\n          </div>\n        </li>\n      </ul>\n    </li>\n  `;\n};\n\nexport const showLastPageMessage = (lastMessageContainer) => {\n  lastMessageContainer.innerHTML = `\n    <div class='last-message'>We're sorry, but you've reached the end of search results.</div>\n  `;\n};","import { fetchImages } from './js/pixabay-api.js';\nimport {\n  hideLoader,\n  renderGallery,\n  renderLoader,\n  renderToastOnError,\n  renderToastOnSearchEmpty, showLastPageMessage, toggleButtonVisibility,\n} from './js/render-functions.js';\n\nconst form = document.querySelector('form');\nconst submitButton = form.querySelector('button[type=\"submit\"]');\nconst input = document.querySelector('input');\nconst searchResultContainer = document.querySelector('.search-result');\nconst searchLoaderContainer = document.querySelector('.search-loader-container');\nconst lastMessageContainer = document.querySelector('.last-message-container');\nconst loadMoreButton = document.querySelector('.search-load-more');\n\nconst perPage = 15;\nlet currentPage = 1;\nlet lastSearchValue = '';\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  currentPage = 1;\n  searchResultContainer.innerHTML = '';\n  lastMessageContainer.innerHTML = '';\n  loadAndRenderImages(input.value.trim());\n});\n\nloadMoreButton.addEventListener('click', () => {\n  loadAndRenderImages(lastSearchValue, true);\n});\n\nconst loadAndRenderImages = async (searchInput, needToScrollWindow = false) => {\n  if (searchInput.length === 0) {\n    toggleButtonVisibility(loadMoreButton, false);\n    currentPage = 1;\n    renderToastOnSearchEmpty(searchResultContainer);\n    return;\n  }\n\n  toggleButtonVisibility(loadMoreButton, false);\n  renderLoader(searchLoaderContainer);\n  submitButton.disabled = true;\n\n  try {\n    if (lastSearchValue !== searchInput) {\n      currentPage = 1;\n    }\n    lastSearchValue = searchInput;\n    const response = await fetchImages(searchInput, currentPage, perPage);\n\n    if (response.data.hits.length === 0) {\n      renderToastOnSearchEmpty(searchResultContainer);\n    } else {\n      renderGallery(searchResultContainer, response.data.hits);\n      const showedItems = currentPage * perPage;\n\n      const isLastPage = response.data.totalHits - showedItems < 0;\n\n      if (!isLastPage) {\n        toggleButtonVisibility(loadMoreButton, true);\n      } else {\n        showLastPageMessage(lastMessageContainer);\n      }\n\n      if (needToScrollWindow) {\n        const card = document.querySelector('li.search-result-item')\n        const cardRect = card.getBoundingClientRect();\n        const rowGap = 24;\n\n        window.scrollBy({behavior: 'smooth' ,top: 3 * (cardRect.height + rowGap)})\n      }\n\n      currentPage++;\n    }\n  } catch (e) {\n    renderToastOnError(searchLoaderContainer);\n  } finally {\n    hideLoader(searchLoaderContainer);\n    submitButton.disabled = false;\n  }\n};\n\n"],"names":["fetchImages","searchValue","pageNumber","perPage","params","axios","simpleLightboxGallery","SimpleLightbox","renderToastOnSearchEmpty","parentContainer","iziToast","renderToastOnError","renderGallery","images","renderImage","renderLoader","hideLoader","toggleButtonVisibility","button","isShow","image","showLastPageMessage","lastMessageContainer","form","submitButton","input","searchResultContainer","searchLoaderContainer","loadMoreButton","currentPage","lastSearchValue","event","loadAndRenderImages","searchInput","needToScrollWindow","response","showedItems","cardRect"],"mappings":"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"}